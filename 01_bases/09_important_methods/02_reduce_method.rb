require './my_hash.rb'
require 'pry'
require 'json'

p """
The #reduce method (also called #inject) is possibly the most difficult-to-grasp enumerable for new coders. 
The idea is simple enough, though: it reduces an array or hash down to a single object. 
You should use #reduce when you want to get an output of a single value.
"""

p "with array "
my_numbers = [5, 6, 7, 8]
sum = 0

my_numbers.each { |number| sum += number }

sum
#=> 26

p "-------"

my_numbers = [5, 6, 7, 8]

my_numbers.reduce { |sum, number| sum + number }
#=> 26

p "-------"

my_numbers = [5, 6, 7, 8]

my_numbers.reduce(1000) { |sum, number| sum + number }
#=> 1026

# ====================================================================
votes = ["a","a","a","a","a","a","a","a","b","b","b","b","b","b","b"]

hash_votes = votes.reduce(Hash.new(0)) do |result,vote|
	result[vote] +=1
	result

end

puts hash_votes

# ====================================================================

# puts readings_store

my_hash = JSON.load(File.read('my_hash.json'))
puts my_hash
puts my_hash.class

  # binding.pry

# File.open("my_hash.json", "r") do |f|

# 	# puts f
# 	data = nil
# 	f.each_line do |line|
#   	# puts line
#   	data = line
#   end
#   puts data
#   binding.pry
# end


readings_store ={"smart-meter-0"=>
    [{"time"=>"2021-10-21T17:47:23-05:00", "reading"=>1.3645854994063646},
     {"time"=>"2021-10-21T17:47:22-05:00", "reading"=>0.6759086826670165},
     {"time"=>"2021-10-21T17:47:21-05:00", "reading"=>0.9653987882356585},
     {"time"=>"2021-10-21T17:47:20-05:00", "reading"=>0.7014467911639659},
     {"time"=>"2021-10-21T17:47:19-05:00", "reading"=>0.6983592837260363},
     {"time"=>"2021-10-21T17:47:18-05:00", "reading"=>1.2783796115411832},
     {"time"=>"2021-10-21T17:47:17-05:00", "reading"=>1.4828788362079233},
     {"time"=>"2021-10-21T17:47:16-05:00", "reading"=>0.8413987843170027},
     {"time"=>"2021-10-21T17:47:15-05:00", "reading"=>0.6260429486833164},
     {"time"=>"2021-10-21T17:47:14-05:00", "reading"=>1.0662622167124687},
     {"time"=>"2021-10-21T17:47:13-05:00", "reading"=>0.9766212565063143},
     {"time"=>"2021-10-21T17:47:12-05:00", "reading"=>1.0628381246881107},
     {"time"=>"2021-10-21T17:47:11-05:00", "reading"=>1.4760339305968824},
     {"time"=>"2021-10-21T17:47:10-05:00", "reading"=>0.8484880304660681},
     {"time"=>"2021-10-21T17:47:09-05:00", "reading"=>1.3877668416822309},
     {"time"=>"2021-10-21T17:47:08-05:00", "reading"=>1.142048787553635},
     {"time"=>"2021-10-21T17:47:07-05:00", "reading"=>1.4652965901131485},
     {"time"=>"2021-10-21T17:47:06-05:00", "reading"=>1.1673272419544136},
     {"time"=>"2021-10-21T17:47:05-05:00", "reading"=>1.1065597247197625},
     {"time"=>"2021-10-21T17:47:04-05:00", "reading"=>0.6868382399964119}],
   "smart-meter-1"=>
    [{"time"=>"2021-10-21T17:47:23-05:00", "reading"=>1.0297365904542066},
     {"time"=>"2021-10-21T17:47:22-05:00", "reading"=>0.9767597804589118},
     {"time"=>"2021-10-21T17:47:21-05:00", "reading"=>1.1800629558546003},
     {"time"=>"2021-10-21T17:47:20-05:00", "reading"=>1.0511748855630565},
     {"time"=>"2021-10-21T17:47:19-05:00", "reading"=>0.9242073065806329},
     {"time"=>"2021-10-21T17:47:18-05:00", "reading"=>1.3342419449361258},
     {"time"=>"2021-10-21T17:47:17-05:00", "reading"=>0.6370893535115368},
     {"time"=>"2021-10-21T17:47:16-05:00", "reading"=>1.0405360983697256},
     {"time"=>"2021-10-21T17:47:15-05:00", "reading"=>0.5514220395702903},
     {"time"=>"2021-10-21T17:47:14-05:00", "reading"=>1.1308385208061429},
     {"time"=>"2021-10-21T17:47:13-05:00", "reading"=>0.711495101293752},
     {"time"=>"2021-10-21T17:47:12-05:00", "reading"=>1.39210605548608},
     {"time"=>"2021-10-21T17:47:11-05:00", "reading"=>1.4172438964439134},
     {"time"=>"2021-10-21T17:47:10-05:00", "reading"=>0.7402040233406241},
     {"time"=>"2021-10-21T17:47:09-05:00", "reading"=>0.5262959082533908},
     {"time"=>"2021-10-21T17:47:08-05:00", "reading"=>1.0174377368467613},
     {"time"=>"2021-10-21T17:47:07-05:00", "reading"=>0.6128843294609362},
     {"time"=>"2021-10-21T17:47:06-05:00", "reading"=>1.0968736611266607},
     {"time"=>"2021-10-21T17:47:05-05:00", "reading"=>1.495838234809489},
     {"time"=>"2021-10-21T17:47:04-05:00", "reading"=>1.4523991833916572}],
   "smart-meter-2"=>
    [{"time"=>"2021-10-21T17:47:23-05:00", "reading"=>1.093471402999955},
     {"time"=>"2021-10-21T17:47:22-05:00", "reading"=>0.509777505308889},
     {"time"=>"2021-10-21T17:47:21-05:00", "reading"=>0.5535877656082054},
     {"time"=>"2021-10-21T17:47:20-05:00", "reading"=>1.0938828361617356},
     {"time"=>"2021-10-21T17:47:19-05:00", "reading"=>1.2479157247112302},
     {"time"=>"2021-10-21T17:47:18-05:00", "reading"=>0.9826033574391266},
     {"time"=>"2021-10-21T17:47:17-05:00", "reading"=>1.3025448990389572},
     {"time"=>"2021-10-21T17:47:16-05:00", "reading"=>1.497821482205977},
     {"time"=>"2021-10-21T17:47:15-05:00", "reading"=>1.3274271596462537},
     {"time"=>"2021-10-21T17:47:14-05:00", "reading"=>1.1221766925194605},
     {"time"=>"2021-10-21T17:47:13-05:00", "reading"=>1.0902937529664278},
     {"time"=>"2021-10-21T17:47:12-05:00", "reading"=>0.6811631200760397},
     {"time"=>"2021-10-21T17:47:11-05:00", "reading"=>0.5384884909007983},
     {"time"=>"2021-10-21T17:47:10-05:00", "reading"=>1.2605299181241802},
     {"time"=>"2021-10-21T17:47:09-05:00", "reading"=>1.3879663384061036},
     {"time"=>"2021-10-21T17:47:08-05:00", "reading"=>0.8830157558437035},
     {"time"=>"2021-10-21T17:47:07-05:00", "reading"=>0.8213653013063417},
     {"time"=>"2021-10-21T17:47:06-05:00", "reading"=>1.4409283600547353},
     {"time"=>"2021-10-21T17:47:05-05:00", "reading"=>1.0490760483595445},
     {"time"=>"2021-10-21T17:47:04-05:00", "reading"=>0.5204023586688677}],
   "smart-meter-3"=>
    [{"time"=>"2021-10-21T17:47:23-05:00", "reading"=>1.2953234358101642},
     {"time"=>"2021-10-21T17:47:22-05:00", "reading"=>1.049532895156437},
     {"time"=>"2021-10-21T17:47:21-05:00", "reading"=>1.2944725524374598},
     {"time"=>"2021-10-21T17:47:20-05:00", "reading"=>0.7844750275559991},
     {"time"=>"2021-10-21T17:47:19-05:00", "reading"=>0.6813865288770022},
     {"time"=>"2021-10-21T17:47:18-05:00", "reading"=>0.7479982540626853},
     {"time"=>"2021-10-21T17:47:17-05:00", "reading"=>1.0675400520020126},
     {"time"=>"2021-10-21T17:47:16-05:00", "reading"=>0.5133056639674499},
     {"time"=>"2021-10-21T17:47:15-05:00", "reading"=>0.6050294594394546},
     {"time"=>"2021-10-21T17:47:14-05:00", "reading"=>1.2774114691868221},
     {"time"=>"2021-10-21T17:47:13-05:00", "reading"=>0.9227756778256675},
     {"time"=>"2021-10-21T17:47:12-05:00", "reading"=>1.206244110058345},
     {"time"=>"2021-10-21T17:47:11-05:00", "reading"=>1.063349487336169},
     {"time"=>"2021-10-21T17:47:10-05:00", "reading"=>1.413752921442717},
     {"time"=>"2021-10-21T17:47:09-05:00", "reading"=>0.8462881708178439},
     {"time"=>"2021-10-21T17:47:08-05:00", "reading"=>1.2735172377407322},
     {"time"=>"2021-10-21T17:47:07-05:00", "reading"=>0.6114253208900919},
     {"time"=>"2021-10-21T17:47:06-05:00", "reading"=>0.5390487023189272},
     {"time"=>"2021-10-21T17:47:05-05:00", "reading"=>1.2514239727947758},
     {"time"=>"2021-10-21T17:47:04-05:00", "reading"=>0.9767560403623408}],
   "smart-meter-4"=>
    [{"time"=>"2021-10-21T17:47:23-05:00", "reading"=>1.268877316899784},
     {"time"=>"2021-10-21T17:47:22-05:00", "reading"=>0.622963815994405},
     {"time"=>"2021-10-21T17:47:21-05:00", "reading"=>1.2048810203156868},
     {"time"=>"2021-10-21T17:47:20-05:00", "reading"=>0.5659891708889848},
     {"time"=>"2021-10-21T17:47:19-05:00", "reading"=>1.4908478479745677},
     {"time"=>"2021-10-21T17:47:18-05:00", "reading"=>0.5251740673394988},
     {"time"=>"2021-10-21T17:47:17-05:00", "reading"=>1.22350268672889},
     {"time"=>"2021-10-21T17:47:16-05:00", "reading"=>0.6747660461883386},
     {"time"=>"2021-10-21T17:47:15-05:00", "reading"=>1.3096529501341634},
     {"time"=>"2021-10-21T17:47:14-05:00", "reading"=>1.4790446974174085},
     {"time"=>"2021-10-21T17:47:13-05:00", "reading"=>1.1548642738720925},
     {"time"=>"2021-10-21T17:47:12-05:00", "reading"=>1.2140337061093451},
     {"time"=>"2021-10-21T17:47:11-05:00", "reading"=>0.598706259218144},
     {"time"=>"2021-10-21T17:47:10-05:00", "reading"=>1.458147357202993},
     {"time"=>"2021-10-21T17:47:09-05:00", "reading"=>0.7549497417065887},
     {"time"=>"2021-10-21T17:47:08-05:00", "reading"=>0.9314840574544655},
     {"time"=>"2021-10-21T17:47:07-05:00", "reading"=>0.995653742813173},
     {"time"=>"2021-10-21T17:47:06-05:00", "reading"=>1.416755893487827},
     {"time"=>"2021-10-21T17:47:05-05:00", "reading"=>1.3312188636722957},
     {"time"=>"2021-10-21T17:47:04-05:00", "reading"=>1.3981113374062677}]
}
	puts "para sacar el average de esa mierda "

puts readings_store

data = readings_store['smart-meter-4']
data.reduce(0){|suma,element| suma+element['reading']}/data.length




data1 = readings_store["smart-meter-3"]
data1.map{|item| item['reading']}

# binding.pry


average = readings_store['smart-meter-4'].reduce(0){|sum, element| sum+element['reading']} / readings_store['smart-meter-4'].length 
puts average

average_1 = readings_store['smart-meter-4'].map{|element| element['reading']}.sum / readings_store['smart-meter-4'].length
puts average_1 

average_2 = readings_store['smart-meter-4'].map{|element| element['reading']}.inject(:+) / readings_store['smart-meter-4'].length
puts average_2 

binding.pry


[{"egrets" => 17}, {"egrets" => 21}].reduce({}, :merge)  